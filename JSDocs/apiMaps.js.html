<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: apiMaps.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: apiMaps.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
function myMap() {
    var map;
    var mapProp;
    mapProp = {
        center: new google.maps.LatLng(47.8310667, 15.174334),
        zoom: 4,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
}

function clearOverlays() {
    for (var i = 0; i &lt; markers.length; i++) {
        markers[i].setMap(null);
    }
    markers.length = 0;
}
*/

/**
 * Crea un mapa con los marcadores de las ciudades con los ciclos elegidos
 * @param {*} elegidos Array con los ciclos elegidos a mostrar
 */
function marcarBueno(elegidos) {
    /*
    markers.forEach(element => {
        element.setMap(null);
    });
*/
    var zoom = mediaQ();
    let markers = [];
    // clearOverlays();

    let mapProp = {
        center: new google.maps.LatLng(47.8310667, 15.174334),
        zoom: zoom,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    let map = new google.maps.Map(document.getElementById("googleMap"), mapProp);

    elegidos.forEach(element => {
        //Utiliza la api de google incluye el geocoder, pasandolo direccion devuelve latitud y logitud
        var geocoder = new google.maps.Geocoder();
        var string = element.ciudad + ", " + element.pais;
        var ciclo = element.ciclo;

        geocoder.geocode({
            address: string
        }, function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                var myCenter = new google.maps.LatLng(
                    //Resultados asignados a myCenter
                    results[0].geometry.location.lat(),
                    results[0].geometry.location.lng()
                );
                //Nuevo marcador
                var marker = new google.maps.Marker({
                    //Posicion es myCenter
                    position: myCenter,
                    //Animacion
                    animation: google.maps.Animation.BOUNCE,
                    contentString: ciclo
                });

                //Añadir al mapa
                marker.setMap(map);

                marker.addListener("click", function () {
                    //Inforwindow para el marcador
                    var infowindow = new google.maps.InfoWindow({
                        content: ciclo
                    });
                    //Mensaje
                    infowindow.open(map, marker);
                });
                markers.push(marker);
            } else {
                //Algo mal
            }
            console.log(status);
        })
    })
}

/**
 * Funcion que modifica el zoom dependiendo del dispositivo
 * que lo está utilizando
 */
function mediaQ() {
    let zoom = 4;
    let query = Modernizr.mq('(min-width: 400px)');
    if (query) {
        console.log("Es mayor que ");
        zoom = 4;
    } else {
        console.log("Es menor que ")
        zoom = 6;
    }
    return zoom;
}

/*
function obtenerPosicion(sitio) {
    var geocoder = new google.maps.Geocoder();
    var nuevoSitio;
    console.log(sitio);
    geocoder.geocode({
        'address': sitio.ciudad + ', ' + sitio.pais
    }, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            alert(results[0].geometry.location.lat() + ", " + results[0].geometry.location.lng());
            
            nuevoSitio = new movilidadLocalizacion(sitio.tipo, sitio.ciclo, sitio.pais, sitio.ciudad,
                results[0].geometry.location.lat(), results[0].geometry.location.lng());
                
        }
        console.log(results);
        console.log(status);
        console.log(nuevoSitio);
        elegidos.push(nuevoSitio);
    });
}

function obtenerPosiciones() {
    var ubicacionElegidos = [];
    

    for (let index = 0; index &lt; elegidos.length; index++) {
        var geocoder = new google.maps.Geocoder();
        geocoder.geocode({
            'address': elegidos[index].ciudad + ', ' + elegidos[index].pais
        }, function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                alert(results[0].geometry.location.lat() + ", " + results[0].geometry.location.lng());
                ubicacionElegidos.push(new movilidadLocalizacion(elegidos[index].tipo, elegidos[index].ciclo,
                    elegidos[index].pais, elegidos[index].ciudad, results[0].geometry.location.lat(), results[0].geometry.location.lng()));
            }
            console.log(results);
            console.log(status);
        });
    }
    console.log(elegidos);
    console.log(ubicacionElegidos);
    alert("lo va a enviar");
    //marcar(ubicacionElegidos);
}

function marcar() {
    var infowindow = new google.maps.InfoWindow();
    var marker, i;
    for (i = 0; i &lt; elegidos.length; i++) {
        marker = new google.maps.Marker({
            position: new google.maps.LatLng(elegidos[i][4], elegidos[i][5]),
            map: map
        });

        google.maps.event.addListener(marker, 'click', (function (marker, i) {
            return function () {
                infowindow.setContent(elegidos[i][1]);
                infowindow.open(map, marker);
            }
        })(marker, i));
    }
}
*/</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#buscarMarcados">buscarMarcados</a></li><li><a href="global.html#clear">clear</a></li><li><a href="global.html#crearCheck">crearCheck</a></li><li><a href="global.html#crearOpciones">crearOpciones</a></li><li><a href="global.html#createElement">createElement</a></li><li><a href="global.html#deleteTreeElements">deleteTreeElements</a></li><li><a href="global.html#existeLocalizacion">existeLocalizacion</a></li><li><a href="global.html#filtrar">filtrar</a></li><li><a href="global.html#marcarBueno">marcarBueno</a></li><li><a href="global.html#mediaQ">mediaQ</a></li><li><a href="global.html#movilidad">movilidad</a></li><li><a href="global.html#movilidadLocalizacion">movilidadLocalizacion</a></li><li><a href="global.html#recupearJson">recupearJson</a></li><li><a href="global.html#recuperarTipos">recuperarTipos</a></li><li><a href="global.html#rellenarLimpiando">rellenarLimpiando</a></li><li><a href="global.html#todos">todos</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Dec 06 2017 12:42:50 GMT+0000 (Hora estándar GMT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
